# FiftyOne Manager 使用手冊

> 資料集管理與標籤編輯簡明指南

## 📋 目錄

1. [系統介紹](#系統介紹)
2. [管理實例](#管理實例)
3. [瀏覽資料集](#瀏覽資料集)
4. [編輯標籤](#編輯標籤)
5. [常見問題](#常見問題)

---

## 系統介紹

FiftyOne Manager 提供以下功能：

- **管理多個 FiftyOne 實例** - 同時開啟多個資料集
- **瀏覽和檢視資料集** - 視覺化圖片和標註
- **編輯 YOLO 標籤** - 直接修正標註錯誤
- **智慧去重** - 自動偵測重複圖片

### 存取系統

在瀏覽器開啟管理介面（向系統管理員取得網址）：
```
http://192.168.20.178:5050
```
![系統首頁](images/01_overview.png)
---

## 管理實例

### 新增實例

1. 點擊 **「+ 新增實例」**(+ Add Instance)
![新增實例](images/02_add_instance.png)
2. 填寫必要資訊：

| 欄位 | 說明 | 範例 |
|------|------|------|
| **實例名稱** (Instance Name) | 給實例取一個容易辨識的名字。只能使用英文、數字、底線和連字號。名稱不可重複。 | `骰子資料集_1106`<br>`dice_test_001` |
| **連接埠** (Port) | FiftyOne 服務運行的埠號。系統會自動建議可用的埠號（通常是 5151-5160）。每個實例需要不同的埠號。 | `5151`<br>`5152` |
| **資料集路徑** (Dataset Path) | 資料集所在的完整路徑。必須包含 `images/` 和 `labels/` 兩個子資料夾。可以點擊「瀏覽」(Browse) 按鈕選擇，或手動輸入絕對路徑。 | `/data/datasets/dice/1106`<br>`/home/user/datasets/mydata` |
| **類別檔案** (Class File) | 定義物件類別名稱的文字檔。每行一個類別名稱，順序對應類別 ID（從 0 開始）。可選填，若不指定則使用預設類別。 | `classes.txt`<br>`dice_classes.txt` |
| **IoU 閾值** (IoU Threshold) | 去重檢測的相似度標準（0.0-1.0）。數值越高越嚴格，只有非常相似的才算重複。<br>• **0.8**（建議）：平衡設定<br>• **0.9**：嚴格<br>• **0.7**：寬鬆 | `0.8` |
| **除錯模式** (Debug Mode) | 開啟後，重複圖片會依群組分類到不同資料夾。關閉時，所有重複圖片會放在同一個資料夾。一般使用者建議關閉。 | ☐ 不勾選（預設） |
| **CVAT 同步** (CVAT Sync) | 是否自動建立 CVAT 專案。需要系統管理員先設定 CVAT 伺服器連線。一般使用者建議關閉。 | ☐ 不勾選（預設） |

### 資料集結構要求

資料夾必須包含 `images/` 和 `labels/` 子資料夾：

```
您的資料集/
├── images/       # 圖片檔案
│   ├── img001.jpg
│   └── ...
└── labels/       # YOLO 標註檔案
    ├── img001.txt
    └── ...
```

### 啟動與操作

- **啟動** (Start) - 載入資料集並執行去重檢測
- **開啟** (Open) - 在新分頁開啟 FiftyOne
- **日誌** (Logs) - 查看運行狀態和錯誤訊息
- **停止** (Stop) - 關閉實例
- **重新啟動** (Restart) - 重啟實例
- **編輯** (Edit) - 修改設定（需先停止）
- **刪除** (Delete) - 移除實例（不會刪除資料集檔案）

![FiftyOne 介面](images/03_fiftyone.png)

### 實例狀態

| 狀態 | 說明 |
|------|------|
| 🟢 Running | 可以開啟使用 |
| ⚫ Stopped | 需要先啟動 |
| 🔴 Error | 啟動失敗，檢查日誌 |

---

## 瀏覽資料集

### FiftyOne 基本操作

![網格檢視](images/04_grid_view.png)

**網格檢視**：
- 點擊圖片查看詳細資訊
- 調整縮圖大小

**詳細檢視**：
- `← →` 切換上/下一張
- `ESC` 返回網格檢視
- 滾輪縮放圖片

### 篩選功能

使用側邊欄篩選：
- **依類別** - 只顯示特定類別的圖片
- **依標籤數量** - 顯示特定數量標註的圖片
- **依檔名** - 搜尋檔名關鍵字

### 快速鍵

| 按鍵 | 功能 |
|------|------|
| `← →` | 切換圖片 |
| `ESC` | 返回網格 |
| `F5` | 重新整理 |
| `` ` `` | 開啟操作選單 |

**macOS 補充**：
- 重新整理請用 `⌘+R`
- `` ` `` 按鍵通常與 `~` 同一顆鍵（英數輸入法）

---

## 編輯標籤

### 開啟編輯器

**步驟 1：在 FiftyOne 中選擇圖片**

![選擇圖片](images/05_select_image.png)

點擊圖片進入詳細檢視模式。

**步驟 2：開啟操作選單並選擇編輯工具**

![選擇 Edit Label in Tool](images/06_select_edit_tool.png)
![操作選單圖示](images/06_menu_icon.png)

按 `` ` `` 鍵（或點擊右上角三條線的選單圖示），搜尋並選擇 **Edit Label in Tool**。

**步驟 3：確認執行**

![確認執行對話框](images/07_confirm_execute.png)

FiftyOne 會顯示確認框，告知將開啟多少張圖片進行編輯。點擊 **Execute** (執行) 按鈕。

**步驟 4：開啟編輯器 URL**

![編輯器 URL 訊息框](images/08_editor_url_box.png)

FiftyOne 會顯示一個訊息框，包含編輯器 URL 和圖片資訊。請複製 URL，開啟新分頁後貼上進入編輯器。

**步驟 5：編輯器介面**

![編輯器介面](images/09_editor.png)

編輯器包含以下區域：
- **頂部工具列**：Previous/Next/Reload/Save Labels 按鈕
- **中央畫布**：圖片和標註框
- **右側面板**：Select Class 和 Annotations 列表
- **底部**：圖片縮圖列表

### 編輯操作

**新增標註**：
1. 選擇類別
2. 在圖片上拖曳繪製邊界框
3. 調整位置和大小

**刪除標註**：
點擊右側標註列表中的紅色 **Delete** 按鈕

**修改類別**：
1. 先點擊標註選中它（邊界框會變粗）
2. 然後點擊右側 **Select Class** 區域中的類別按鈕
3. 或使用 `W/S` 鍵快速切換類別

**調整邊界框**：
選中標註後，拖曳邊界框的**角落**或**邊緣**來調整大小

⚠️ **注意**：邊界框無法直接拖曳移動位置，只能調整大小。如需移動，請刪除後重新繪製。

### 儲存變更

1. 點擊頂部右側的藍色 **Save Labels** 按鈕

⚠️ **注意**：`Ctrl+S` 會觸發瀏覽器的「儲存網頁」功能，請使用滑鼠點擊 **Save Labels** 按鈕。
⚠️ **注意**：FiftyOne 不會即時自動更新標籤檔，修改後沒有立即反映是正常的。

**其他頂部按鈕**：
- **← Previous** - 切換到上一張圖片
- **Next →** - 切換到下一張圖片
- **Reload** - 重新載入當前圖片

### 快速鍵

| 按鍵 | 功能 |
|------|------|
| `W` | 切換到上一個類別 |
| `S` | 切換到下一個類別 |
| `Delete` | 刪除標籤 |

---

## 常見問題

### 實例無法啟動

1. 點擊 **日誌** (Logs) 按鈕查看錯誤訊息
2. 檢查常見問題：
   - 資料集路徑是否正確
   - 是否包含 `images/` 和 `labels/` 資料夾
   - 連接埠是否已被使用
3. 聯絡系統管理員

### 編輯器無法開啟

- FiftyOne 會顯示訊息框，包含編輯器 URL
- 複製 URL，開啟新分頁後貼上進入編輯器
- URL 格式：`http://伺服器IP:埠號/label-editor.html?...`

### 儲存後沒有更新

- FiftyOne 不會自動更新標籤檔，修改後沒有立即反映是正常的
- 回到 FiftyOne Manager 點擊 **Restart** 重新啟動該實例，再重新開啟 FiftyOne

### 復原重複圖片

重複圖片在 `duplicate/` 資料夾，可以手動移回：
1. 找到 `duplicate/images/` 和 `duplicate/labels/`
2. 將檔案移回 `images/` 和 `labels/`
3. 重新啟動實例

---

## 💡 使用技巧

**提高效率**：
- 使用鍵盤快速鍵
  - `W/S` 快速切換類別
  - `Delete` 刪除標籤
- 善用篩選功能
- 一次開啟多個實例處理不同資料集
- 編輯器中經常點擊 **Save Labels** 按鈕

**避免錯誤**：
- ❌ 不要同時在不同的編輯器修改同一張圖片
- ❌ 不要在實例運行時刪除資料夾
- ✅ 編輯完標籤後立即儲存
- ✅ 遇到問題先查看日誌

---

## 📚 附錄

### 取得協助

聯絡系統管理員，並提供：
1. 問題描述
2. 操作步驟
3. 錯誤截圖
4. 實例日誌

---

**記住重點**：

1. 🟢 確保實例運行中再開啟 FiftyOne
2. 💾 編輯標籤後記得儲存
3. 🔄 儲存後按 F5 重新整理
4. 📋 遇到問題先查看日誌

---
